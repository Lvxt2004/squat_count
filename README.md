# 深蹲计数系统

基于 AI 姿态识别的实时深蹲计数系统，使用 MediaPipe 进行人体姿态检测，KNN 机器学习模型进行姿态分类。

## 功能特点

- **实时深蹲计数**：自动识别蹲下和站立状态，完成一次完整深蹲动作后计数 +1
- **多角度支持**：支持正面、侧面、斜面三种面向摄像头的角度
- **全身检测**：自动检测用户全身是否在画面内，未检测到时显示提示
- **Web 界面**：美观的实时视频流界面，显示计数、姿态、置信度等信息

## 技术实现

### 姿态检测
使用 MediaPipe Pose 检测人体 33 个关键点，提取有意义的几何特征进行分类。

### 特征提取

**姿态分类（站立/蹲下）- 12 维特征：**
- 肩部、髋部、膝盖到脚踝的归一化距离
- 膝关节角度（髋-膝-踝）
- 髋关节角度（肩-髋-膝）
- 躯干与大腿夹角
- 身体各部位相对位置比例

**角度分类（正面/侧面/斜面）- 8 维特征：**
- 肩部、髋部连线与水平轴的夹角
- 左右肩、左右髋的宽度
- 左右肩、左右髋的深度差（z 坐标）
- 肩宽与髋宽比值

### 模型训练
- 使用 KNN 分类器
- GridSearchCV 自动搜索最优超参数
- 5 折交叉验证

## 项目结构

```
squat_count_opus/
├── app.py              # Flask Web 应用
├── squat_counter.py    # 深蹲计数器核心逻辑
├── train_models.py     # 模型训练脚本
├── requirements.txt    # 依赖包
├── models/             # 训练好的模型
├── data_csv/           # 训练数据
└── templates/          # 前端页面
```

## 使用方法

### 安装依赖
```bash
pip install -r requirements.txt
```

### 训练模型（可选，已提供预训练模型）
```bash
python train_models.py
```

### 启动应用
```bash
python app.py
```

打开浏览器访问 http://localhost:5000

## 使用说明

1. 确保摄像头可用
2. 站在摄像头前，保持全身在画面内
3. 进行深蹲动作，系统会自动计数
4. 点击"重置计数"按钮可清零
